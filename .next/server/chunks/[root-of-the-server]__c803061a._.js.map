{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/ab/dev/grhog/GRHOG/src/config/api.ts"],"sourcesContent":["// API Configuration\nexport const API_CONFIG = {\n  // Base URL for the backend API - point to actual backend server\n  // For client-side requests, always use Next.js API routes to avoid CORS issues\n  // For server-side requests, use the direct backend URL\n  BASE_URL: (() => {\n    if (typeof window !== 'undefined') {\n      // Client-side: use Next.js API routes\n      return '/api';\n    }\n    // Server-side: use direct backend URL\n    return process.env.BACKEND_URL || 'http://device.grhog.mn';\n  })(),\n\n  // API endpoints\n  ENDPOINTS: {\n    AUTH: {\n      SIGNIN: '/auth/signin',\n      SIGNOUT: '/auth/signout',\n      REFRESH: '/auth/refresh',\n      VALIDATE: '/auth/validate',\n      STATUS: '/auth/status'\n    },\n    BINS: '/bins',\n    CLIENTS: '/clients',\n    BIN_USAGES: '/bin-usages',\n    CLEARINGS: '/clearings',\n    DASHBOARD: {\n      ACTIVE_BINS: '/dashboard/active-bins',\n      ACTIVE_CARDS: '/dashboard/active-cards',\n      CURRENT_USAGE: '/dashboard/current-usage',\n      TOTAL_HOUSEHOLDS: '/dashboard/household-count',\n      AVERAGE_BIN_FILLING: '/dashboard/average-bin-filling',\n      COLLECTION_TRENDS: '/dashboard/collection-trends',\n      BIN_STATUS_DISTRIBUTION: '/dashboard/bin-status-distribution',\n      DAILY_USAGE_TREND: '/dashboard/daily-usage-trend',\n      LOCATION_STATS: '/dashboard/location-stats',\n      GET_DISTRICT: '/dashboard/getDistrict',\n      GET_KHOROO: '/dashboard/getKhoroo',\n      CLIENT_TYPE_COUNTS: '/dashboard/client-type-counts',\n      ALL_BINS: '/dashboard/all-bins',\n      CLIENT_ACTIVITY_CHANGE: '/dashboard/client-activity-change'\n    },\n    ANALYTICS: {\n      BIN_STATISTICS: '/analytics/bin-statistics',\n      USAGE_STATISTICS: '/analytics/usage-statistics',\n      PENETRATION_ANALYSIS: '/analytics/penetration-analysis',\n      CLEARING_EFFICIENCY: '/analytics/clearing-efficiency'\n    },\n    STATISTICS: {\n      BINS: {\n        TOTAL_BINS: '/bins/total-bins',\n        AVERAGE_FILL_LEVEL: '/bins/average-fill-level',\n        AVERAGE_BATTERY: '/bins/average-battery',\n        WARNING_BINS: '/bins/warning-bins'\n      },\n      CARDS: {\n        TOTAL_CARDS: '/cards/total-cards',\n        TOTAL_ACCESS: '/cards/total-access',\n        ACTIVITY_RATE: '/cards/activity-rate'\n      },\n      TRANSACTIONS: {\n        TODAY_USAGE: '/transactions/today-usage',\n        TODAY_AVERAGE: '/transactions/today-average',\n        ACTIVE_BINS_TODAY: '/transactions/active-bins-today',\n        OVERALL_AVERAGE: '/transactions/overall-average'\n      }\n    },\n    CLIENT_ACTIVITY: '/clients',\n    TEST: '/test',\n    USERS: '/users'\n  },\n\n  // Request configuration\n  REQUEST_CONFIG: {\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    timeout: 10000 // 10 seconds\n  }\n} as const;\n\n// Helper function to build full API URLs\nexport const buildApiUrl = (endpoint: string): string => {\n  return `${API_CONFIG.BASE_URL}${endpoint}`;\n};\n\n// Helper function to get API endpoint\nexport const getApiEndpoint = (path: string): string => {\n  const endpoint =\n    API_CONFIG.ENDPOINTS[path as keyof typeof API_CONFIG.ENDPOINTS];\n  if (typeof endpoint === 'string') {\n    return endpoint;\n  }\n  return path;\n};\n"],"names":[],"mappings":"AAAA,oBAAoB;;;;;;AACb,MAAM,aAAa;IACxB,gEAAgE;IAChE,+EAA+E;IAC/E,uDAAuD;IACvD,UAAU,CAAC;QACT;;QAIA,sCAAsC;QACtC,OAAO,QAAQ,GAAG,CAAC,WAAW,IAAI;IACpC,CAAC;IAED,gBAAgB;IAChB,WAAW;QACT,MAAM;YACJ,QAAQ;YACR,SAAS;YACT,SAAS;YACT,UAAU;YACV,QAAQ;QACV;QACA,MAAM;QACN,SAAS;QACT,YAAY;QACZ,WAAW;QACX,WAAW;YACT,aAAa;YACb,cAAc;YACd,eAAe;YACf,kBAAkB;YAClB,qBAAqB;YACrB,mBAAmB;YACnB,yBAAyB;YACzB,mBAAmB;YACnB,gBAAgB;YAChB,cAAc;YACd,YAAY;YACZ,oBAAoB;YACpB,UAAU;YACV,wBAAwB;QAC1B;QACA,WAAW;YACT,gBAAgB;YAChB,kBAAkB;YAClB,sBAAsB;YACtB,qBAAqB;QACvB;QACA,YAAY;YACV,MAAM;gBACJ,YAAY;gBACZ,oBAAoB;gBACpB,iBAAiB;gBACjB,cAAc;YAChB;YACA,OAAO;gBACL,aAAa;gBACb,cAAc;gBACd,eAAe;YACjB;YACA,cAAc;gBACZ,aAAa;gBACb,eAAe;gBACf,mBAAmB;gBACnB,iBAAiB;YACnB;QACF;QACA,iBAAiB;QACjB,MAAM;QACN,OAAO;IACT;IAEA,wBAAwB;IACxB,gBAAgB;QACd,SAAS;YACP,gBAAgB;QAClB;QACA,SAAS,MAAM,aAAa;IAC9B;AACF;AAGO,MAAM,cAAc,CAAC;IAC1B,OAAO,GAAG,WAAW,QAAQ,GAAG,UAAU;AAC5C;AAGO,MAAM,iBAAiB,CAAC;IAC7B,MAAM,WACJ,WAAW,SAAS,CAAC,KAA0C;IACjE,IAAI,OAAO,aAAa,UAAU;QAChC,OAAO;IACT;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///home/ab/dev/grhog/GRHOG/src/app/api/auth/signin/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { API_CONFIG } from '@/config/api';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    console.log('Auth request received:', { username: body.username, passwordLength: body.password?.length });\n    \n    // Validate request body\n    if (!body.username || !body.password) {\n      console.error('Missing username or password');\n      return NextResponse.json(\n        { error: 'Username and password are required' },\n        { status: 400 }\n      );\n    }\n    \n    const backendUrl = process.env.BACKEND_URL || 'http://device.grhog.mn';\n    console.log('Attempting to authenticate with backend:', `${backendUrl}${API_CONFIG.ENDPOINTS.AUTH.SIGNIN}`);\n    \n    const response = await fetch(`${backendUrl}${API_CONFIG.ENDPOINTS.AUTH.SIGNIN}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        username: body.username,\n        password: body.password\n      }),\n    });\n\n    console.log('Backend response status:', response.status);\n    console.log('Backend response headers:', Object.fromEntries(response.headers.entries()));\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      console.error('Backend authentication failed:', {\n        status: response.status,\n        statusText: response.statusText,\n        errorText: errorText\n      });\n      \n      // Return more specific error messages\n      if (response.status === 401) {\n        return NextResponse.json(\n          { error: 'Invalid username or password' },\n          { status: 401 }\n        );\n      } else if (response.status === 403) {\n        return NextResponse.json(\n          { error: 'Access forbidden' },\n          { status: 403 }\n        );\n      } else if (response.status === 404) {\n        return NextResponse.json(\n          { error: 'Authentication endpoint not found' },\n          { status: 404 }\n        );\n      } else {\n        return NextResponse.json(\n          { error: `Backend error: ${response.status} ${response.statusText}` },\n          { status: response.status }\n        );\n      }\n    }\n\n    // The AuthController returns a JSON object with token and user data\n    const authResponse = await response.json();\n    console.log('Authentication successful, response received:', authResponse ? 'Yes' : 'No');\n    \n    if (!authResponse || !authResponse.token) {\n      console.error('No valid response received from backend');\n      return NextResponse.json(\n        { error: 'No valid response received from backend' },\n        { status: 500 }\n      );\n    }\n    \n    // Create response with cookie set for middleware authentication\n    const nextResponse = NextResponse.json(authResponse);\n    nextResponse.cookies.set('auth-token', 'authenticated', {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      sameSite: 'lax',\n      maxAge: 60 * 60 * 24 * 7, // 7 days\n      path: '/'\n    });\n    \n    return nextResponse;\n    \n  } catch (error) {\n    console.error('Auth route error:', error);\n    \n    // Check if it's a network error\n    if (error instanceof TypeError && error.message.includes('fetch')) {\n      return NextResponse.json(\n        { error: 'Cannot connect to backend server. Please check if the backend is running.' },\n        { status: 503 }\n      );\n    }\n    \n    return NextResponse.json(\n      { error: 'Authentication failed due to server error' },\n      { status: 500 }\n    );\n  }\n} "],"names":[],"mappings":"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","debugId":null}}]
}